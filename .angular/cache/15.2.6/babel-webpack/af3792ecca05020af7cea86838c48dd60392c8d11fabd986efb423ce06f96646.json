{"ast":null,"code":"import { Subject, takeUntil } from 'rxjs';\nimport { ProductFormComponent } from '../../components/product-form/product-form.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../services/products/products.service\";\nimport * as i2 from \"src/app/shared/services/products/products-data-transfer.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"primeng/api\";\nimport * as i5 from \"primeng/dynamicdialog\";\nimport * as i6 from \"../../../../shared/components/toolbar-navigation/toolbar-navigation.component\";\nimport * as i7 from \"primeng/confirmdialog\";\nimport * as i8 from \"../../components/products-table/products-table.component\";\nconst _c0 = function () {\n  return {\n    width: \"50vw\"\n  };\n};\nexport class ProductsHomeComponent {\n  constructor(productsService, productsDtService, router, messageService, confirmationService, dialogService) {\n    this.productsService = productsService;\n    this.productsDtService = productsDtService;\n    this.router = router;\n    this.messageService = messageService;\n    this.confirmationService = confirmationService;\n    this.dialogService = dialogService;\n    this.destroy$ = new Subject();\n    this.productsDatas = [];\n  }\n  ngOnInit() {\n    this.getServiceProductsDatas();\n  }\n  getServiceProductsDatas() {\n    const productsLoaded = this.productsDtService.getProductsDatas();\n    if (productsLoaded.length > 0) {\n      this.productsDatas = productsLoaded;\n    } else this.getAPIProductsDatas();\n  }\n  getAPIProductsDatas() {\n    this.productsService.getAllProducts().pipe(takeUntil(this.destroy$)).subscribe({\n      next: response => {\n        if (response.length > 0) {\n          this.productsDatas = response;\n        }\n      },\n      error: err => {\n        console.log(err);\n        this.messageService.add({\n          severity: 'error',\n          summary: 'Erro',\n          detail: 'Erro ao buscar produtos',\n          life: 2500\n        });\n        this.router.navigate(['/dashboard']);\n      }\n    });\n  }\n  handleProductAction(event) {\n    if (event) {\n      this.ref = this.dialogService.open(ProductFormComponent, {\n        header: event?.action,\n        width: '70%',\n        contentStyle: {\n          overflow: 'auto'\n        },\n        baseZIndex: 10000,\n        maximizable: true,\n        data: {\n          event: event,\n          productDatas: this.productsDatas\n        }\n      });\n      this.ref.onClose.pipe(takeUntil(this.destroy$)).subscribe({\n        next: () => this.getAPIProductsDatas()\n      });\n    }\n  }\n  handleDeleteProductAction(event) {\n    if (event) {\n      this.confirmationService.confirm({\n        message: `Confirma a exclusão do produto: ${event?.productName}?`,\n        header: 'Confirmação de exclusão',\n        icon: 'pi pi-exclamation-triangle',\n        acceptLabel: 'Sim',\n        rejectLabel: 'Não',\n        accept: () => this.deleteProduct(event?.product_id)\n      });\n    }\n  }\n  deleteProduct(product_id) {\n    if (product_id) {\n      this.productsService.deleteProduct(product_id).pipe(takeUntil(this.destroy$)).subscribe({\n        next: response => {\n          if (response) {\n            this.messageService.add({\n              severity: 'success',\n              summary: 'Sucesso',\n              detail: 'Produto removido com sucesso!',\n              life: 2500\n            });\n            this.getAPIProductsDatas();\n          }\n        },\n        error: err => {\n          console.log(err);\n          this.messageService.add({\n            severity: 'error',\n            summary: 'Erro',\n            detail: 'Erro ao remover produto!',\n            life: 2500\n          });\n        }\n      });\n    }\n  }\n  ngOnDestroy() {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n}\nProductsHomeComponent.ɵfac = function ProductsHomeComponent_Factory(t) {\n  return new (t || ProductsHomeComponent)(i0.ɵɵdirectiveInject(i1.ProductsService), i0.ɵɵdirectiveInject(i2.ProductsDataTransferService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.MessageService), i0.ɵɵdirectiveInject(i4.ConfirmationService), i0.ɵɵdirectiveInject(i5.DialogService));\n};\nProductsHomeComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ProductsHomeComponent,\n  selectors: [[\"app-products-home\"]],\n  decls: 3,\n  vars: 4,\n  consts: [[3, \"products\", \"productEvent\", \"deleteProductEvent\"]],\n  template: function ProductsHomeComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelement(0, \"app-toolbar-navigation\");\n      i0.ɵɵelementStart(1, \"app-products-table\", 0);\n      i0.ɵɵlistener(\"productEvent\", function ProductsHomeComponent_Template_app_products_table_productEvent_1_listener($event) {\n        return ctx.handleProductAction($event);\n      })(\"deleteProductEvent\", function ProductsHomeComponent_Template_app_products_table_deleteProductEvent_1_listener($event) {\n        return ctx.handleDeleteProductAction($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(2, \"p-confirmDialog\");\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"products\", ctx.productsDatas);\n      i0.ɵɵadvance(1);\n      i0.ɵɵstyleMap(i0.ɵɵpureFunction0(3, _c0));\n    }\n  },\n  dependencies: [i6.ToolbarNavigationComponent, i7.ConfirmDialog, i8.ProductsTableComponent],\n  encapsulation: 2\n});","map":{"version":3,"mappings":"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","names":["Subject","takeUntil","ProductFormComponent","ProductsHomeComponent","constructor","productsService","productsDtService","router","messageService","confirmationService","dialogService","ngOnInit","getServiceProductsDatas","productsLoaded","getProductsDatas","length","productsDatas","getAPIProductsDatas","getAllProducts","pipe","destroy$","subscribe","next","response","error","err","console","log","add","severity","summary","detail","life","navigate","handleProductAction","event","ref","open","header","action","width","contentStyle","overflow","baseZIndex","maximizable","data","productDatas","onClose","handleDeleteProductAction","confirm","message","productName","icon","acceptLabel","rejectLabel","accept","deleteProduct","product_id","ngOnDestroy","complete","selectors","decls","vars","consts","template","i0","ctx"],"sourceRoot":"","sources":["C:\\Users\\CaioCoelho\\Desktop\\AULA-55\\src\\app\\modules\\products\\page\\products-home\\products-home.component.ts","C:\\Users\\CaioCoelho\\Desktop\\AULA-55\\src\\app\\modules\\products\\page\\products-home\\products-home.component.html"],"sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Subject, takeUntil } from 'rxjs';\nimport { ConfirmationService, MessageService } from 'primeng/api';\nimport { ProductsService } from '../../../../services/products/products.service';\nimport { ProductsDataTransferService } from 'src/app/shared/services/products/products-data-transfer.service';\nimport { GetAllProductsResponse } from 'src/app/models/interfaces/products/response/GetAllProductsResponse';\nimport { EventAction } from 'src/app/models/interfaces/products/event/EventAction';\nimport { DialogService, DynamicDialogRef } from 'primeng/dynamicdialog';\nimport { ProductFormComponent } from '../../components/product-form/product-form.component';\n\n@Component({\n  selector: 'app-products-home',\n  templateUrl: './products-home.component.html',\n  styleUrls: [],\n})\nexport class ProductsHomeComponent implements OnInit, OnDestroy {\n  private readonly destroy$: Subject<void> = new Subject();\n  private ref!: DynamicDialogRef;\n  public productsDatas: Array<GetAllProductsResponse> = [];\n\n  constructor(\n    private productsService: ProductsService,\n    private productsDtService: ProductsDataTransferService,\n    private router: Router,\n    private messageService: MessageService,\n    private confirmationService: ConfirmationService,\n    private dialogService: DialogService\n  ) {}\n\n  ngOnInit(): void {\n    this.getServiceProductsDatas();\n  }\n\n  getServiceProductsDatas() {\n    const productsLoaded = this.productsDtService.getProductsDatas();\n\n    if (productsLoaded.length > 0) {\n      this.productsDatas = productsLoaded;\n    } else this.getAPIProductsDatas();\n  }\n\n  getAPIProductsDatas() {\n    this.productsService\n      .getAllProducts()\n      .pipe(takeUntil(this.destroy$))\n      .subscribe({\n        next: (response) => {\n          if (response.length > 0) {\n            this.productsDatas = response;\n          }\n        },\n        error: (err) => {\n          console.log(err);\n          this.messageService.add({\n            severity: 'error',\n            summary: 'Erro',\n            detail: 'Erro ao buscar produtos',\n            life: 2500,\n          });\n          this.router.navigate(['/dashboard']);\n        },\n      });\n  }\n\n  handleProductAction(event: EventAction): void {\n    if (event) {\n      this.ref = this.dialogService.open(ProductFormComponent, {\n        header: event?.action,\n        width: '70%',\n        contentStyle: { overflow: 'auto' },\n        baseZIndex: 10000,\n        maximizable: true,\n        data: {\n          event: event,\n          productDatas: this.productsDatas,\n        },\n      });\n      this.ref.onClose.pipe(takeUntil(this.destroy$)).subscribe({\n        next: () => this.getAPIProductsDatas(),\n      });\n    }\n  }\n\n  handleDeleteProductAction(event: {\n    product_id: string;\n    productName: string;\n  }): void {\n    if (event) {\n      this.confirmationService.confirm({\n        message: `Confirma a exclusão do produto: ${event?.productName}?`,\n        header: 'Confirmação de exclusão',\n        icon: 'pi pi-exclamation-triangle',\n        acceptLabel: 'Sim',\n        rejectLabel: 'Não',\n        accept: () => this.deleteProduct(event?.product_id),\n      });\n    }\n  }\n\n  deleteProduct(product_id: string) {\n    if (product_id) {\n      this.productsService\n        .deleteProduct(product_id)\n        .pipe(takeUntil(this.destroy$))\n        .subscribe({\n          next: (response) => {\n            if (response) {\n              this.messageService.add({\n                severity: 'success',\n                summary: 'Sucesso',\n                detail: 'Produto removido com sucesso!',\n                life: 2500,\n              });\n\n              this.getAPIProductsDatas();\n            }\n          },\n          error: (err) => {\n            console.log(err);\n            this.messageService.add({\n              severity: 'error',\n              summary: 'Erro',\n              detail: 'Erro ao remover produto!',\n              life: 2500,\n            });\n          },\n        });\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.complete();\n  }\n}\n","<app-toolbar-navigation></app-toolbar-navigation>\n\n<app-products-table\n  [products]=\"productsDatas\"\n  (productEvent)=\"handleProductAction($event)\"\n  (deleteProductEvent)=\"handleDeleteProductAction($event)\"\n></app-products-table>\n<p-confirmDialog [style]=\"{ width: '50vw' }\"></p-confirmDialog>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}